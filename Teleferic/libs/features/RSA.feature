Feature: RSA Module

  @wip
  Scenario Outline: Sign menssage
    Given <privkey>
    """-----BEGIN RSA PRIVATE KEY-----
    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
    -----END RSA PRIVATE KEY-----"""
    And message as <message>
    And signature as <given_sign>
    And I sign <message> with <privkey> and store it on <current_sign>
    And I compare <current_sign> with <given_sign>
    Then sign should be <result>
 
    Examples:
    | message | given_sign | result |
    | valid | 7edf52fbaf6a079aa934cabfe6192c5faa7191fee35d374958651703b036d1f8f6fcebdc15d13a86ac9f1ab1ab08448d407b5bc83ec7dd5b13a879c221ae184f3faaabbdb536081f3fd4eba8f72d22cf216a4e8dc70c585dd002786d47b34349372969fbe0c940a105521700a86c76e673ddc4a97989607eba621d89ef0b8a1a183460730f6e007237628532959ee30b7b0bf1f247e0191bfdc95ba442f9145594ddbc655544c7c346bad690f5d6322da6e3c55c8c4859c86bc95638884d6122b153612ad29ca7e7b19b48162e2da3cb0d729f2786c4d5e1782e403b737dbc3f79994cfec9f1321fb5414ca44fe77596964a1b98cb617894a7cab9bc398e9fe8066f8a7d60a6e637396075548edb4db1c03e32517368e6ab70568f5de886101583b5eec0b7499867cda67ac7d008a620d4dd59ee480a05354eba9975c1ca0a6f60d8cba0e05e9c30a8174714c3ad3abbd55bdfe5cde119ed4b1383e11ddb18483238d61ba0aa2b09f84128e7407754d45f9bef6b07f5b60df9e38eabfdc46ce8495c889a0db641fd2e78c25029ef8e1a493562ee18491893c378294a2c106afb5f8a085934eb1b7b712fd5cf67a9e6eb851d93b78950e57cc7e2802b470c23596d6846336712d72a140687351198ee0f52722b6e3124e6fd2dcb491c2a336c6dd7b7b583d6e7a2673f29efc3ccfb48afde4510965f9a5758f96d3332cfae5687 | valid |
    | invalid | 5714d932494ec273d84ac9063aa9155a10b61eec775847681446e78d96109cea77cc0a2b567a97403cc28fb09532dac8dcd089a7384391f9f911d9beba3214a3a57aebf70e455852b9e9e4ae923fcc8b7968bba48be2a7dbedd5ee3d23325db58b250d3daae52ae3dd1bb73a64f522fcb0d46abd399bdc1deb5bbd889de2d1d00a16cb7549722cad9e72a197dbf272456778c4c168d0cf9ba1e97e423ad687d525b9b8e6685048f87bea85dc7e6852b821b01f43dd033f4bdf79b0907d27c40a1d214cbaab4639e150c6fcc144e4cb6b6a33eb9e61954ffc77bb1ad92c3d3729943f8baa6884052553dde1e273a1f30cdca519bc44b0c130e310907ea4f5b74f | invalid |
    | invalid | 17d36bfd49bef02e417450e8d8b9ae9eabc157fa03c151ebe9742fa643d5e39d082a92aa77c01a1ee1b56b3b01e79fbf7d3521e92bb4341b6d7804c2f61eda702a8d1323f415a2d2c3f67c10f680103dfa0d676f82f8a9790bf39927905a703ade0797a9cb5aa9159eeb7bac1dbd978e52f830923ba0b1a9598e4f1fd07ac706d516e4da6725adb992a34d8837a5d484438b0b0d0878e59a016b01963cddef6fe1ba2693cb0146ba50ba27d7ef5d3abbc68dc1adbcc80e586032eedd7071c53153ee2c7c6c05401ea31884df04f08f79295c8f2452a790e4010da3996f34d22cc9ebe585c8c3168fc49052074f0c85afbd616ab25e446f8ae795e77fbbaad602357f5b194716280b951481eb6519ee4f59e1337ac53c32737fb953d48aeb9938c76c6a0efc91661730776d0af746db5723ca04cbfd92af1c86c8c28137c47558262bb70590cbe217903dad0fb543340d387b8f4ceb70ecddd0ce58b578161d2c7958611f8284da866eb201a3ddab912f0cd31d0546bb2eda10fce3b47ac9eee393dfe627914127a50c243884a0f00095a3b0610f0ba56da123ecc7227232355e70c2c9b082bd90179dc2a8dab7ec3b49897fb1ba910c3088770222987413026f2924611f7013615e6dbdb3da0a82ca0784186d56e5b4048e62f3be8445fae34155e20d013f05e60177362ba5a35e3305573e4e71b85a6a5275a3dda93477bb20 | valid |
    | valid | 38272fb8230ce0c74526294e0768bf37254528f3541596f72b6b29fac8ee7d4366ac3b14af6419e0eaa625c1181d4915ed9a359266d2480923d2930927d5254a0bc4dfe73ee11d50c17fc0828965a424ed013a0f5c1e204667f0f4a53034aeababc4e1cd6902b26c403edf811587b84ffe9e704c1bd88cbe7ea2b437660b12c24fcb83ce86d47e7afba0283b6221a339d71bb59ccfb3ae9db13e56f06ef0f9c4c8ce77e8bd907f1b3e1a78bc7aed15e1ac0ba2492b471ee41faf5aca38d41b8534fbc2fb25fa2ab7f252bcee2306538a8c41805783f37543e5c574b99e16f19756aa1ae20bb636dc239575e3b026120689da1f1902a0a52dccbaee71cef6b37d | invalid |